<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>Flappy Bird</title>

<style>
:root{
  --bg:#d9ecff;
  --panel:#ffffff;
  --text:#14304a;
  --blue:#2f79ff;
  --pink:#ff5f95;
  --mint:#22b8a8;
}

*{box-sizing:border-box;margin:0;padding:0}

body{
  font-family:system-ui,Arial,sans-serif;
  background:var(--bg);
  color:var(--text);
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
}

.app{
  width:100%;
  max-width:420px;
  background:var(--panel);
  border-radius:24px;
  padding:16px;
  box-shadow:0 20px 40px rgba(0,0,0,.15);
}

header{
  text-align:center;
  margin-bottom:10px;
}

h1{font-size:26px}
.sub{font-size:14px;opacity:.75}

.controls{
  display:flex;
  gap:10px;
  margin:12px 0;
}

select,button{
  flex:1;
  padding:12px;
  font-size:16px;
  border-radius:14px;
  border:2px solid rgba(0,0,0,.15);
  background:#fff;
  font-weight:700;
}

button.primary{
  background:var(--blue);
  color:#fff;
  border:none;
}

canvas{
  width:100%;
  height:360px;
  border-radius:18px;
  background:#cfe8ff;
  display:block;
  touch-action:none;
}

.status{
  display:flex;
  justify-content:space-between;
  margin-top:10px;
  font-weight:800;
}

.overlay{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,.5);
  display:flex;
  align-items:center;
  justify-content:center;
}

.modal{
  background:#fff;
  padding:20px;
  border-radius:20px;
  text-align:center;
  width:80%;
}

.modal h2{margin-bottom:10px}
.hidden{display:none}
</style>
</head>

<body>

<div class="app">
  <header>
    <h1>Flappy Bird</h1>
    <p class="sub">Tippen oder Space zum Fliegen</p>
  </header>

  <div class="controls">
    <select id="difficulty">
      <option value="easy">Leicht (langsam)</option>
      <option value="normal" selected>Normal</option>
      <option value="fast">Schnell</option>
    </select>
    <button class="primary" id="startBtn">Start</button>
  </div>

  <canvas id="game"></canvas>

  <div class="status">
    <span>Score: <span id="score">0</span></span>
    <span>Best: <span id="best">0</span></span>
  </div>
</div>

<!-- START / GAME OVER -->
<div class="overlay hidden" id="overlay">
  <div class="modal">
    <h2 id="overlayTitle">Bereit?</h2>
    <p id="overlayText">Dr√ºcke Start</p>
    <button class="primary" id="overlayBtn">Start</button>
  </div>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const scoreEl = document.getElementById("score");
const bestEl = document.getElementById("best");
const difficultySel = document.getElementById("difficulty");

const overlay = document.getElementById("overlay");
const overlayTitle = document.getElementById("overlayTitle");
const overlayText = document.getElementById("overlayText");
const overlayBtn = document.getElementById("overlayBtn");
const startBtn = document.getElementById("startBtn");

let W,H;
function resize(){
  W = canvas.clientWidth;
  H = canvas.clientHeight;
  canvas.width = W;
  canvas.height = H;
}
resize();
window.addEventListener("resize", resize);

let bird, pipes, running=false, score=0, best=0;
best = Number(localStorage.getItem("flappy_best")||0);
bestEl.textContent = best;

function params(){
  if(difficultySel.value==="easy") return {speed:120, gap:170};
  if(difficultySel.value==="fast") return {speed:220, gap:130};
  return {speed:170, gap:150};
}

function reset(){
  bird = {x:W*0.3,y:H/2,vy:0,r:12};
  pipes = [];
  score=0;
  scoreEl.textContent=0;
}

function start(){
  reset();
  running=true;
  overlay.classList.add("hidden");
}

function gameOver(){
  running=false;
  if(score>best){
    best=score;
    localStorage.setItem("flappy_best",best);
    bestEl.textContent=best;
  }
  overlayTitle.textContent="Game Over";
  overlayText.textContent="Score: "+score;
  overlayBtn.textContent="Neustart";
  overlay.classList.remove("hidden");
}

function flap(){
  if(!running) start();
  bird.vy = -300;
}

function spawnPipe(){
  const {gap} = params();
  const y = 60 + Math.random()*(H-gap-120);
  pipes.push({x:W+40,y,passed:false});
}

let last=0,spawnT=0;
function loop(ts){
  if(!last) last=ts;
  const dt=(ts-last)/1000;
  last=ts;

  ctx.clearRect(0,0,W,H);

  if(running){
    const {speed,gap}=params();
    bird.vy+=900*dt;
    bird.y+=bird.vy*dt;

    spawnT+=dt;
    if(spawnT>1.4){ spawnPipe(); spawnT=0; }

    pipes.forEach(p=>p.x-=speed*dt);
    pipes=pipes.filter(p=>p.x>-60);

    pipes.forEach(p=>{
      if(!p.passed && p.x+40<bird.x){
        p.passed=true;
        score++;
        scoreEl.textContent=score;
      }
      if(bird.x+bird.r>p.x && bird.x-bird.r<p.x+40){
        if(bird.y-bird.r<p.y || bird.y+bird.r>p.y+gap){
          gameOver();
        }
      }
    });

    if(bird.y+bird.r>H-10 || bird.y-bird.r<0) gameOver();
  }

  // draw pipes
  ctx.fillStyle="#2f79ff";
  pipes.forEach(p=>{
    ctx.fillRect(p.x,0,40,p.y);
    ctx.fillRect(p.x,p.y+params().gap,40,H);
  });

  // draw bird
  ctx.fillStyle="#ff5f95";
  ctx.beginPath();
  ctx.arc(bird.x,bird.y,bird.r,0,Math.PI*2);
  ctx.fill();

  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);

// input
canvas.addEventListener("pointerdown",e=>{e.preventDefault();flap();});
window.addEventListener("keydown",e=>{
  if(e.code==="Space"){e.preventDefault();flap();}
});

startBtn.onclick=()=>start();
overlayBtn.onclick=()=>start();
overlay.classList.remove("hidden");
</script>

</body>
</html>
